\documentclass[fleqn]{article}
\author{Authors from Deltares and USGS}

\usepackage{amsmath}

\begin{document}

\title{Variably Saturated Flow in MODFLOW 6}
\maketitle

\tableofcontents

\section{Theoretical Development}
In this section ...

\subsection{Conservation of Mass}
In case of variably saturated flow, the void space is occupied by 
two fluid phases, air and water, and a full description includes
the simultaneous flow of both phases. For the process described here
it is assumed that there is no mass transfer between the fases and
the air is stagnant such that its pressure equals zero everywhere.
Under those conditions, the differential macroscopic mass balance 
equation for the water phase has the form (c.f. equation~(6.3.3)
in Bear and Cheng, 2010):

\begin{equation}
  \frac{\partial (\rho s \phi)}{\partial t} +
  \nabla \cdot (\rho \mathbf{q}) -
  \rho \Gamma = 0,
  \label{eq-balance-equation}
\end{equation}
where
\begin{eqnarray*}
  \rho &=& \textrm{liquid density, [ML\textsuperscript{-3}]} \\
  s &=& \textrm{liquid saturation, [-]} \\
  \phi &=& \textrm{porosity, [-]} \\
  t &=& \textrm{time, [T]} \\
  \mathbf{q} &=& \textrm{vector of liquid flux per unit area, [LT\textsuperscript{-1}]} \\
  \Gamma &=& \textrm{volumetric source-sink term accounting for liquid added to} \\
  && \textrm{($\Gamma > 0$) or taken away ($-\Gamma < 0$) from the volume $\Omega$, per unit} \\
  && \textrm{volume per unit time, [T\textsuperscript{-1}]}
\end{eqnarray*}
Integrating equation~\ref{eq-balance-equation} over a volume of porous
medium $V$ bounded by a surface $\sigma$, and applying Gauss's theorem
leads to:
\begin{equation}
  \int_V \frac{\partial (\rho s \phi)}{\partial t} \,dV +
  \oint_\sigma \rho \mathbf{q} \cdot \mathbf{n} d\sigma -
  \int_V \rho \Gamma \,dV = 0,
  \label{eq-conservation}
\end{equation}
where $\mathbf{n}$ equals the normal vector to the surface $\sigma$. 
Equation~\ref{eq-conservation} states that the rate of change of
mass stored in $V$ must be balanced by the sum of liquid flux across
the surface boundary of $V$ and of liquid added by sources or removed
at sinks.

The volume $V$ is assumed small enough that within it, the
liquid density ($\rho$), saturation ($s$), and porosity ($\phi$) can be
considered constant "representative" values, such that the first term of
equation~\ref{eq-conservation} can be expressed as
\begin{equation}
  \int_V \frac{\partial (\rho s \phi)}{\partial t} \,dV = 
  V \frac{\partial (\rho s \phi)}{\partial t},
\end{equation}
and the third term as
\begin{equation}
  \int_V \rho \Gamma \,dV = \rho \Gamma V.
\end{equation}
Equation~\ref{eq-conservation} now becomes
\begin{equation}
  V \frac{\partial (\rho s \phi)}{\partial t} +
  \oint_\sigma \rho \mathbf{q} \cdot \mathbf{n} d\sigma -
  \rho \Gamma V = 0.
\end{equation}

\subsection{Fluid-Flux Equation}
The fluid flux $\mathbf{q}$ is given by Darcy's law for unsaturated flow:
\begin{equation}
  \mathbf{q} = - \frac{\mathbf{k}(s)}{\mu} \cdot ( \nabla p + \rho g \nabla z ),
\end{equation}
where the permeability of the medium $\mathbf{k}$ depends on its saturation $s$,
$\mu$ is the dynamic viscosity, $p$ the pressure of the fluid, and $g$ the
gravitational acceleration. For constant density and ignoring the temperature
dependence of viscosity, this can be writtten in terms of hydraulic head
$h$ as
\begin{equation}
  \mathbf{q} = - \mathbf{K}(s) \cdot \nabla h,
  \label{eq-unsat-darcy-flux}
\end{equation}
with $\mathbf{K}$ a rank-2 tensor of hydraulic conductivity. The hydraulic
head equals the sum of the pressure head $h_p$ and the vertical
coordinate $z$:
\begin{equation}
  h = h_p + z.
\end{equation}

The concept of relative permeability is commonly used to
state the dependence of the conductivity on saturation. For
example, for an isotropic porous medium:
\begin{equation}
  \mathbf{q} = - k_\textrm{r}(s) K_{\textrm{sat}} \nabla h,
\end{equation}
where $K_\textrm{sat}$ is the hydraulic conductivity tensor at full saturation,
the relative permeability is given by:
\begin{equation}
  k_\textrm{r} = \frac{K(s)}{K_{\textrm{sat}}}.
\end{equation}
This can be easily extended to the anisotropic case if the principal axes
of the conductivity tensor are aligned with the coordinate axes:
\begin{equation}
  \mathbf{K}(s) = \mathbf{k}_{\textrm{r}} \cdot \mathbf{K}_{\textrm{sat}}
                = 
                \begin{bmatrix}
                  k_r^x & 0 & 0 \\
                  0 & k_r^y & 0 \\
                  0 & 0 & k_r^z
                \end{bmatrix} \cdot
                \begin{bmatrix}
                  K_{\text{sat}}^x & 0 & 0 \\
                  0 & K_{\text{sat}}^y & 0 \\
                  0 & 0 & K_{\text{sat}}^z
                \end{bmatrix},
\end{equation}
although this poses the challenge to determine not one but three, in
this case direction dependent, relative permeability functions. In case the 
medium is anisotropic and the axes are not aligned, the conductivity tensor
follows from the previous expression by a rotation of coordinates:
\begin{equation}
  \mathbf{K}(s) \rightarrow \mathbf{R} \mathbf{K}(s) \mathbf{R^T}
                = (\mathbf{R} \mathbf{k}_{\textrm{r}} \mathbf{R^T}) \cdot 
                  (\mathbf{R} \mathbf{K}_{\textrm{sat}} \mathbf{R^T}),
\end{equation}
with $\mathbf{R}$ a general three-dimensional rotation matrix such that
$\mathbf{R}\mathbf{R^T} = \mathbf{1}$. This can in principle be used
to treat variably saturated flow in three-dimensional anisotropic media,
consistent with the XT3D capability \cite{modflow6xt3d} available in
MODFLOW 6 for saturated groundwater flow. For practical reasons, such
as limiting the challenge of calibrating the conductivities in a model,
it is assumed that relative permeability is isotropic. This
implies that equation~\ref{eq-unsat-darcy-flux} can be written as
\begin{equation}
  \mathbf{q} = - k_\text{r}(s) \mathbf{K}_{\textrm{sat}} \cdot \nabla h,
\end{equation}
where $k_r$ is a scalar function of saturation. Although this approximation
has been used in many simulation codes 
(e.g., \cite{vs2d,modflowvsf,vosssutra,panday-surfact}), it has been
pointed out that the effect of saturation generally depends on 
direction \cite{bear-1987}.

Substituting the expression for the fluid flux into equation~\ref{eq-conservation}
leads to
\begin{equation}
  V \frac{\partial (\rho s \phi)}{\partial t} -
  \oint_\sigma \rho k_\text{r}(s) \mathbf{K}_{\textrm{sat}}
  \cdot \nabla h \cdot \mathbf{n} d\sigma -
  \rho \Gamma V = 0.
\end{equation}

If the terms in the surface integral can be considered constant over each of the 
$m$ faces of an arbitrary prismatic volume element (isotropic!?), 
this can be written as:
\begin{equation}
  V \frac{\partial (\rho s \phi)}{\partial t} -
  \rho \sum_{\alpha=1}^{m} \overline{k_r K_{\textrm{sat}}}
  \left[\frac{\partial h}{\partial n}\right]_\alpha \sigma_\alpha -
  \rho \Gamma V = 0,
  \label{eq-diff-csv}
\end{equation}
where $\sigma_\alpha$ equals the area of the $\alpha$ face and the bar indicates 
that an effective value is used for hydraulic conductivity, to be discussed 
in more detail in section~\ref{sec-cond-avg}. Additionally, the head 
gradient is assumed to be normal to the faces bounding the volume which
means that for any face $\alpha$ it follows that:
$(\nabla h)_\alpha = (\partial h/\partial n)_\alpha \mathbf{n_\alpha}$.

\subsection{Storage Term}
The change in mass of water that is held in storage is given by the first 
term in equation~\ref{eq-diff-csv}. This can be expressed in terms of hydraulic
head, the principal dependent variable for solving the system of equations,
as follows:
\begin{equation}
  \frac{\partial (\rho s \phi)}{\partial t} =
  \left[
    s \phi \frac{\partial \rho}{\partial h} +
    \rho s \frac{\partial \phi}{\partial h}
  \right]
  \frac{\partial h}{\partial t} +  
  \rho \phi \frac{\partial s}{\partial t}.
  \label{eq-sto-terms}
\end{equation}
Between brackets are two distinct terms contributing to the water
added to or released from storage due to changes of the hydraulic
head: the fluid compressibility term to account for changes in the
fluid density $\rho$ and a term to represent the (elastic)
compression of the solid matrix given by the change in the porosity
of the medium $\phi$. The last term on the right acounts holds the
change in soil saturation, which is a function of pressure head $h_p$, 
or, in this case where the $z$ coordinate is fixed, of hydraulic 
head: $s = s(h)$.

For any particular type of soil or geologic formation, these variables
are assumed to be a function of pressure only. The following definitions
are introduced to restructure the right-hand side of
equation~\ref{eq-sto-terms}:
\begin{eqnarray*}
  &&\text{Fluid compressibility coefficient: }
    \beta_c = \frac{1}{\rho} \frac{\partial \rho}{\partial p} \\
  &&\text{Solid matrix compressibility coefficient: }
    \alpha_c = \frac{\partial \phi}{\partial p}.
\end{eqnarray*}
Now with the approximation that the density of water depends on
pressure only, $\rho = \rho(p)$, the change in storage can be written
as:
\begin{equation}
  \frac{\partial (\rho s \phi)}{\partial t} =
  \rho s S_s \frac{\partial h}{\partial t} +
  \rho \phi \frac{\partial s}{\partial t}.
  \label{eq-sto}
\end{equation}
The specific storage in this equation is defined as
\begin{equation}
  S_s = \rho g \left( \phi \beta_c + \alpha_c \right).
  \label{eq-spec-sto}
\end{equation}

\subsection{Variably Saturated Flow Equation}
Putting the results from the previous sections together,
substituting the storage terms (equation~\ref{eq-sto}) into the 
differential form of the balance law (equation~\ref{eq-diff-csv}), 
leads to Richards' equation, a nonlinear partial differential equation for 
variably saturated flow:
\begin{equation}  
  V
  \left(
    s S_s \frac{\partial h}{\partial t} + 
    \phi \frac{\partial s}{\partial t}
  \right) -
  \sum_{\alpha=1}^{m} \overline{k_r K_{\textrm{sat}}}
  \left[\frac{\partial h}{\partial n}\right]_\alpha \sigma_\alpha -
  \Gamma V = 0.
  \label{eq-unsat-flow}
\end{equation}
with (repeated here for convenience):
\begin{eqnarray*}
  V &=& \text{the representative elementary volume} \\
  s &=& \text{water saturation} \\
  S_s &=& \text{specific storage} \\
  h &=& \text{hydraulic head} \\
  \phi &=& \text{porosity} \\
  \overline{k_r} &=& \text{effective relative permeability} \\
  \overline{K} &=& \text{effective hydraulic conductivity} \\
  (\partial h/\partial n)_\alpha &=& \text{head gradient normal to face $\alpha$} \\
  \sigma_\alpha &=& \text{surface area of face $\alpha$} \\
  \Gamma &=& \text{volumetric source-sink term}
\end{eqnarray*}

Note that as the medium approaches full saturation, the derivative
$\partial s/ \partial t$ vanishes and $k_r$ becomes equal to 1.
In that case, the above expression converges smoothly to the saturated
groundwater flow equation used in MODFLOW~6:
\begin{equation}
  V S_s \frac{\partial h}{\partial t} -
  \sum_{\alpha=1}^{m} \overline{K_{\textrm{sat}}}
  \left[\frac{\partial h}{\partial n}\right]_\alpha \sigma_\alpha -
  \Gamma V = 0.
  \label{eq-sat-flow}
\end{equation}
It is this concept of
continuity that is used to integrate the variably saturated flow 
mechanism into the existing flow formulation.


\subsection{Initial and Boundary Conditions}\label{sec-boundary-conditions}


\subsection{Analytical Functions for Soil Properties}
\subsubsection*{Water Retention Curve}
\subsubsection*{Specific Moisture Capacity}
\subsubsection*{Relative Hydraulic Conductivity}
\subsubsection*{Hysteresis}

\section{Numerical Solution}
Equation~\ref{eq-unsat-flow}, together with the boundary conditions as
described in section~\ref{sec-boundary-conditions}, is a highly non-linear
partial differential equation that has no general closed-form solution.
Although it can be considered a more advanced description of unconfined
and partially saturated groundwater flow than the standard formulation
available in MODFLOW 6, the solution strategy is the same. The variably
saturated flow equation is discretized using a controle-volume
finite-difference (CVFD) method. The method replaces the continuum of
coordinates in equation~\ref{eq-unsat-flow} with a discrete set of 
points in space and time. The control volume is called a cell and the
point at the center of the cell a node. The collection of cells with
their connections is the model grid. The partial derivatives in the
equation can be approximated by differencing head values between 
neighbouring cells and between subsequent time values. The resulting
finite-difference equations will have terms that are a function
of the discretized dependent variable, such as $k_r = k_r(h)$ and 
$s = s(h)$. These non-linearities can be overcome using a standard
Picard iteration method\footnote{Are we planning to support non-NR
treatment of Richards flow??} or by applying the Newton-Raphson 
linearization that is known to provide more stability when solving for
cells that are under a water-table condition. For each cell in the
the grid that is under variably saturated flow conditions, the
linearized balance terms are added to the system representing the
motion equations in the total (saturated and unsaturated) simulation 
domain. This system is solved by the MODFLOW iterative solver as part
of its outer (non-linear) iteration loop.

\subsubsection*{Water Balance on a Cell}
The variably saturated flow equation in CVFD form can be used to
express the concept of water balance on a cell $n$ as
\begin{equation}
  \sum_{m \in \eta_n} Q_{n,m} + Q_{n, \Gamma} - Q_{n,\Sigma} = 0,
  \label{eq-cell-balance}
\end{equation}
where
\begin{eqnarray*}
  Q_{n,m} &=& \text{flow rate from cell $m$ into $n$} \\
  \eta_n &=& \text{collection of cells connected to $n$} \\
  Q_{n,\Gamma} &=& \text{summed contribution from sources and sinks in the cell} \\
  Q_{n,\Sigma} &=& \text{change in volume of water stored in $n$ per unit time}
\end{eqnarray*}
and the terms in equation~\ref{eq-cell-balance} are all of dimension
[L\textsuperscript{3}T\textsuperscript{-1}]. For every cell $n$, after
reordering, this water balance equation corresponds to the 
$n$\textsuperscript{th} row in the matrix equation
\begin{equation}
  \mathbf{A}\mathbf{h} = \mathbf{b},
  \label{eq-nonlinear-system}
\end{equation}
where $\mathbf{A}$ equals a $n \times n$ coefficient matrix, $\mathbf{h}$
the dependent variable vector at the end of the time step, and
$\mathbf{b}$ the constant terms grouped in a vector that is commonly
referred to as the right-hand side. 

For general variably saturated flow problems, the coefficient matrix is 
nonlinear and depends on the head values that are to be calculated. 
Using the Picard iteration method, equation~\ref{eq-nonlinear-system} 
can be written as
\begin{equation}
  \mathbf{\bar{A}}^{(k-1)} \mathbf{h}^{(k)} = \mathbf{b}^{(k-1)},
  \label{eq-linearized-system}
\end{equation}
such that $\mathbf{h}^{(k)}$ is the head vector at the new iteration level
$k$ and $\mathbf{\bar{A}}^{(k-1)}$ is the linearized coefficient matrix
that no longer depends on $\mathbf{h}^{(k)}$ but is evaluated using values
from the previous iteration level $k-1$ instead, and likewise for 
$\mathbf{b}^{(k-1)}$. Repeatedly formulating and solving the system until 
$\mathbf{h}^{(k)} \approx \mathbf{h}^{(k-1)}$ produces the numerical 
solution of equation~\ref{eq-nonlinear-system}.

In the following sections, discretized expressions are presented for
all the terms in equation~\ref{eq-cell-balance}. These expressions,
together with the linearization procedure and a discrete
formulation of available initial conditions and boundary conditions, 
are required to numerically solve the process of variably saturated 
flow within the MODFLOW 6 framework.

\subsubsection*{Newton-Raphson Linearization}
The Newton-Raphson method is an alternative way of linearizing the
balance equation. First define the residual vector $\mathbf{r}$
for a cell $n$ using the component notation as
\begin{equation}
  r_n = \sum_{m \in \eta_n} Q_{n,m} + 
        Q_{n, \Gamma} - 
        Q_{n,\Sigma}.
  \label{eq-residual-cell}
\end{equation}
The coefficients of the Jacobian matrix $\mathbf{J}$ are given by
\begin{equation}
  J_{n,k} = \frac{\partial r_n}{\partial h_k}.
  \label{eq-jacobian}
\end{equation}
The strategy is to find the change in head $\Delta\mathbf{h}$ that
drives the residual vector to zero. This can be expressed with the
following iterative scheme:
\begin{equation}
  \mathbf{J}^{(k-1)} \Delta \mathbf{h}^{(k)} = -\mathbf{r}^{(k-1)}.
\end{equation}
Rewriting this in a form similar to equation~\ref{eq-linearized-system}
leads to
\begin{equation}
  \mathbf{J}^{(k-1)} \mathbf{h}^{(k)} = 
  -\mathbf{r}^{(k-1)} + \mathbf{J}^{(k-1)} \mathbf{h}^{(k-1)}.
  \label{eq-newton-head}
\end{equation}
The last expression explicitly depends on head instead of the
head upgrade and makes it easier to solve the problem with a
unified implementation for the standard formulation and the
Newton-Raphson method.

Combining equations~\ref{eq-residual-cell}, \ref{eq-jacobian},
and \ref{eq-newton-head}, and separating the diagonal and
off-diagonal part of $\mathbf{J}$, leads to the full CVFD
equation for the Newton-Raphson formulation:
\begin{equation}
  \begin{split}
    \left(
      \sum_{m \in \eta_n} 
        \frac{\partial Q_{n,m}}{\partial h_n} + 
        \frac{\partial Q_{n, \Gamma}}{\partial h_n} - 
        \frac{\partial Q_{n,\Sigma}}{\partial h_n}
    \right) 
    h_n^{(k)} +
    \sum_{m \in \eta_n} \frac{\partial Q_{n,m}}{\partial h_m} 
    h_m^{(k)} =\\
    - 
    \left(
      \sum_{m \in \eta_n} Q_{n,m} + 
      Q_{n, \Gamma} - 
      Q_{n,\Sigma}
    \right) +
    \left(
      \sum_{m \in \eta_n} 
        \frac{\partial Q_{n,m}}{\partial h_n} + 
        \frac{\partial Q_{n, \Gamma}}{\partial h_n} - 
        \frac{\partial Q_{n,\Sigma}}{\partial h_n}
    \right) 
    h_n^{(k-1)}\\
    + \sum_{m \in \eta_n} \frac{\partial Q_{n,m}}{\partial h_m} 
    h_m^{(k-1)},
  \end{split}
\label{eq-cvfd-nr}
\end{equation}
where all coefficients are to be evaluated at iteration $k-1$. 
This is the expression given in the documentation for the
MODFLOW 6 groundwater flow model and is repeated here for
convenience. The following sections will detail the various
contributions to the terms in this equation.

\subsection{Spatial Discretization and Internal Flows}
\subsection{Intercell Averaging of Conductance Terms}\label{sec-cond-avg}
\subsubsection*{Saturated Hydraulic Conductivity}
\subsubsection*{Relative Hydraulic Conductivity}
\subsection{Temporal Discretization and Storage}
For transient simulations, the change in storage is given by
equation~\ref{eq-sto}. Because of the presence of both $h$ and
$s$ as unknowns, this expression is known as the mixed-form
representation of Richards' equation. To proceed with the
numerical solution, a discretized representation of this
term is required. A great deal of research has been concerned
with how to best discretize the storage term such that it maintains
the mass conservation that is inherent to the equation in
the continuous domain. Applying the chain rule of differentiation
to convert the time derivative of saturation to hydraulic head,
i.e., making the substition:
\begin{equation}
  \frac{\partial s}{\partial t} \rightarrow
  \frac{\partial s}{\partial h} 
  \frac{\partial h}{\partial t},
\end{equation}
will generally lead to mass balance errors in case the analytical
(or tangent) derivative for $\partial s/\partial h$ is used. 
A more detailed discussion of the subject can be found in
\cite{rathfelder-1994} and references therein.

Instead of applying the product rule in the continuous domain
and working with the expression on the right-hand side of 
equation~\ref{eq-sto}, the discrete difference is used
as a starting point instead:
\begin{equation}
  \Delta \left ( \rho s \phi \right ) \equiv
  \left ( \rho s \phi \right )^{i} - 
  \left ( \rho s \phi \right )^{i-1} =
  \left ( \rho \phi \right )^{i} s^{i} - 
  \left ( \rho \phi \right )^{i-1} s^{i-1},
  \label{eq-delta_sto}
\end{equation}
where $i$ and $i-1$ label the time levels at which terms
are evaluated and the time interval $\Delta t$ over which the 
change is determined, is given as
\begin{equation}
  \Delta t = t^i - t^{i-1}.
\end{equation}
Respecting equation~\ref{eq-delta_sto} is clearly necessary to conserve
mass, but not sufficient. The evaluation of the individual terms
as so called state functions is essential and deserves particular
attention when converting the dependent variable to head.

Following the existing procecure in MODFLOW 6 for confined and
unconfined groundwater storage, the general equation for storage
contributions to the variably saturated flow equation is:
\begin{equation}
  Q_{\Sigma} = Q_{\Delta s} + Q_{Ss},
\end{equation}
where $Q_{Ss}$ is the volumetric flow rate associated with specific
storage and $Q_{\Delta s}$ the volumetric flow rate resulting from
changes in the water saturation: the unsaturated storage\footnote{
  I don't think this is a correct term,
  but for now let's work with it
}.

\subsubsection*{Specific Storage}
The conversion of $(\rho\phi)^i$ into an expression that depends
on $h^i$, the hydraulic head at the new time level, starts with 
the approximating relation:
\begin{equation}
  (\rho\phi)^i =
  (\rho\phi)^{i-1} + \frac{\Delta (\rho\phi)}{\Delta h} \Delta h \approx
  (\rho\phi)^{i-1} + \rho_\textrm{o} S_s \Delta h,
  \label{eq-rhophi-i}
\end{equation}
with $\rho_{\textrm{o}}$ a constant value for the density
\footnote{@AMP: I feel we need to go over our work carefully to
determine where and how we assume densities to be constant}
and $S_s$, the specific storage, assumed to be constant over
the discretized volume too. Substituting in equation~\ref{eq-delta_sto}
leads to:
\begin{equation}
  \Delta \left ( \rho s \phi \right ) =
  (\rho \phi)^{i-1}\Delta s +
  \rho_{\textrm{o}} S_s s^i \Delta h.
  \label{eq-delta_sto_2}
\end{equation}
After using a backward Euler scheme to approximate the time
derivative, the discretized volumetric flow rate from specific
storage changes for cell $n$ equals:
\begin{equation}
  Q_{n,Ss} = \rho_{\textrm{o}} S_s s_n^i
  \frac{h_n^i - h_n^{i-1}}{\Delta t}.
\end{equation}
In the iterative scheme the current iteration is labeled
by $k$, the expression is then linearized by evaluating
the saturation at the previous iteration level, with the
replacement $s_n^{i,(k)} \rightarrow s_n^{i,(k-1)}$:
\begin{equation}
  Q_{n,Ss} = \rho_{\textrm{o}} S_s s_n^{i,(k-1)} 
  \frac{h_n^{i,(k)} - h_n^{i-1}}{\Delta t}.
\end{equation}
Note that alternatively, equation~\ref{eq-rhophi-i} could have
been used to express $(\rho\phi)^{i-1}$ explicitly in terms 
of $(\rho\phi)^i$ and substitute in equation~\ref{eq-delta_sto}. 
In that case, $Q_{n,Ss}$ would end up being proportional to 
$s^{i-1}$ instead.\footnote{The implications of which are still
to be sorted out, maybe something for the appendix}

To convert the term containing $\Delta s$ in 
equation~\ref{eq-delta_sto_2}, two different 
approaches are available and worked out below: 
a chord slope method discussed in \cite{rathfelder-1994}
and what is generally known as the modified Picard method
\cite{celia-1990}.

\subsubsection*{Unsaturated Storage: Chord Slope Method}
This section will contain our Fort Lauderdale results.

\subsubsection*{Unsaturated Storage: Modified Picard Scheme}
This section will show the Celia way of approximating $\Delta s$.
The compressibility term (specific storage) will be the same.

\subsubsection*{Newton-Raphson Scheme}
The discretized storage in equation~\ref{eq-tbd} is the starting
point for the Newton-Raphson linearization procedure. The required
terms appear in equation~\ref{eq-cvfd-nr} and are given by:
\begin{equation}
  Q_{n,\Sigma}^{(k-1)} = tbd
\end{equation}
and
\begin{equation}
  \left.\frac{\partial Q_{n,\Sigma}}{\partial h_n}\right|^{(k-1)} = tbd
\end{equation}

\subsection{Sources and Sinks}
\subsection{Initial and Boundary Conditions}
\subsection{Adaptive Timestepping}

\section{Integration into MODFLOW 6}
The capability presented in this report offers an alternative flow
formulation in the NPF package for cells that are under variably 
saturated conditions. The storage package (STO) has been extended
to include a more sophisticated treatment of partially saturated
cells. New packages have been developed to account for infiltration (INF),
ponding (PON), ... The existing packages for ... have been modified .

\subsection{Infiltration}
\subsection{Seepage}
\subsection{Ponding}

\section{Model Verification}
\subsection{Analytical Results}
\subsection{Example Problems}

\appendix
\section{Detailed analysis of the storage formulation}
Maybe we can discuss here how the chord slope and the modified
Picard method are related. Similarly, explain the relation
with the Newton-Raphson approach. Following our Ft. Lauderdale
discussions.

\bibliographystyle{plain}
\bibliography{MODFLOW6References,techref} 

\end{document}